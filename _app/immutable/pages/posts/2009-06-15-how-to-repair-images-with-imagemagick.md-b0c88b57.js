import{S as L,i as Z,s as q,D as E,x as z,y as D,z as G,A as U,B as H,r as V,p as J,C as K,L as C,e as f,t as y,k as _,c as g,a as k,h as v,d as n,m as I,b as N,g as i,I as b,n as Q}from"../../chunks/index-f5f19c4c.js";import{P as W}from"../../chunks/post-58fa2fac.js";import"../../chunks/settings-ae4c19cc.js";function X(m){let t,r,p,l,a,o,c,M,w,u,O=`<code class="language-perl"><span class="token comment">#!/usr/bin/perl</span>

processFile<span class="token punctuation">(</span><span class="token string">"$_"</span><span class="token punctuation">)</span> <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">@ARGV</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">#recursively fix images</span>
<span class="token keyword">sub</span> <span class="token function">processFile</span> <span class="token punctuation">&#123;</span>
   <span class="token keyword">my</span> <span class="token variable">$file</span><span class="token operator">=</span>shift<span class="token punctuation">;</span>
   <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token operator">-d</span> <span class="token string">"$file"</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">(</span> <span class="token keyword">do</span><span class="token punctuation">&#123;</span> processFile<span class="token punctuation">(</span><span class="token string">"$_"</span><span class="token punctuation">)</span> <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token string">"$file"</span><span class="token operator">/</span><span class="token operator">*</span><span class="token operator">></span><span class="token punctuation">)</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token string">&#96;convert "$file" "$file"&#96;</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code>`,$,d,P,x,h,j;return{c(){t=f("p"),r=y(`I have been doing a lot of importing of photos on my photo site, and have noticed some images do not display properly.
Since I love ImageMagick so much,\xA0I set up\xA0 my gallery to use it. However, there appears to be a check in the Coppermine
software that aborts reading the file upon errors in the image. So I typed the command \u201Cdisplay imagename.jpg\u201D for some
of the files that did not import properly, and everything appeared to be fine. But I did notice something peculiar about
the images: they were taken with my phone\u2019s camera and all had errors printed out when I tried to open them, but seem to
display correctly.`),p=_(),l=f("p"),a=y(`Since these files could be opened by ImageMagick, I figured if I saved them again, I would be able to fix the errors. I
ran \u201Cconvert image1.jpg image1.jpg\u201D, got the familiar errors printed and opened the file again. This time, no errors!
But since I have a\xA0 lot of files I want to import, I needed a way to convert a bunch at once.`),o=_(),c=f("p"),M=y(`I created a neat little Perl script to do just that. All you need is ImageMagick and perl installed. This script does
not rely on PerlMagick, as it runs the convert command. So here it is:`),w=_(),u=f("pre"),$=_(),d=f("p"),P=y(`I saved this file as $HOME/bin/fiximage. All you need to do to run it is type \u201Cfiximage file1 file2 directory1 directory2 \u2026\u201C.
One other thing to note is that this script has been purposefully shortened. I like to use the ternary operator whenever
possible in my scripts for just this reason. As such, it does not print anything to the command line itself, but if the
convert command encounters an error, that will be printed.`),x=_(),h=f("p"),j=y("I hope you have found this article useful!"),this.h()},l(e){t=g(e,"P",{});var s=k(t);r=v(s,`I have been doing a lot of importing of photos on my photo site, and have noticed some images do not display properly.
Since I love ImageMagick so much,\xA0I set up\xA0 my gallery to use it. However, there appears to be a check in the Coppermine
software that aborts reading the file upon errors in the image. So I typed the command \u201Cdisplay imagename.jpg\u201D for some
of the files that did not import properly, and everything appeared to be fine. But I did notice something peculiar about
the images: they were taken with my phone\u2019s camera and all had errors printed out when I tried to open them, but seem to
display correctly.`),s.forEach(n),p=I(e),l=g(e,"P",{});var S=k(l);a=v(S,`Since these files could be opened by ImageMagick, I figured if I saved them again, I would be able to fix the errors. I
ran \u201Cconvert image1.jpg image1.jpg\u201D, got the familiar errors printed and opened the file again. This time, no errors!
But since I have a\xA0 lot of files I want to import, I needed a way to convert a bunch at once.`),S.forEach(n),o=I(e),c=g(e,"P",{});var A=k(c);M=v(A,`I created a neat little Perl script to do just that. All you need is ImageMagick and perl installed. This script does
not rely on PerlMagick, as it runs the convert command. So here it is:`),A.forEach(n),w=I(e),u=g(e,"PRE",{class:!0});var F=k(u);F.forEach(n),$=I(e),d=g(e,"P",{});var T=k(d);P=v(T,`I saved this file as $HOME/bin/fiximage. All you need to do to run it is type \u201Cfiximage file1 file2 directory1 directory2 \u2026\u201C.
One other thing to note is that this script has been purposefully shortened. I like to use the ternary operator whenever
possible in my scripts for just this reason. As such, it does not print anything to the command line itself, but if the
convert command encounters an error, that will be printed.`),T.forEach(n),x=I(e),h=g(e,"P",{});var B=k(h);j=v(B,"I hope you have found this article useful!"),B.forEach(n),this.h()},h(){N(u,"class","language-perl")},m(e,s){i(e,t,s),b(t,r),i(e,p,s),i(e,l,s),b(l,a),i(e,o,s),i(e,c,s),b(c,M),i(e,w,s),i(e,u,s),u.innerHTML=O,i(e,$,s),i(e,d,s),b(d,P),i(e,x,s),i(e,h,s),b(h,j)},p:Q,d(e){e&&n(t),e&&n(p),e&&n(l),e&&n(o),e&&n(c),e&&n(w),e&&n(u),e&&n($),e&&n(d),e&&n(x),e&&n(h)}}}function Y(m){let t,r;const p=[m[0],R];let l={$$slots:{default:[X]},$$scope:{ctx:m}};for(let a=0;a<p.length;a+=1)l=E(l,p[a]);return t=new W({props:l}),{c(){z(t.$$.fragment)},l(a){D(t.$$.fragment,a)},m(a,o){G(t,a,o),r=!0},p(a,[o]){const c=o&1?U(p,[o&1&&H(a[0]),o&0&&H(R)]):{};o&2&&(c.$$scope={dirty:o,ctx:a}),t.$set(c)},i(a){r||(V(t.$$.fragment,a),r=!0)},o(a){J(t.$$.fragment,a),r=!1},d(a){K(t,a)}}}const R={comments:!0,view:"post",layout:"post",lang:"en",author:"skamansam",title:"How To Repair Images with ImageMagick",description:"Using ImageMagick to repair corrupted images",excerpt:"the images [...] were taken with my phone's camera and all had errors",cover:!1,coverImage:!1,coverAlt:"RBE Logo",categories:["web-development"],tags:["Coppermine","Image Repair"],created_at:"2009-06-15T11:23:00.000Z",updated_at:"2009-06-15T11:23:00.000Z"};function ee(m,t,r){return m.$$set=p=>{r(0,t=E(E({},t),C(p)))},t=C(t),[t]}class se extends L{constructor(t){super(),Z(this,t,ee,Y,q,{})}}export{se as default,R as metadata};
