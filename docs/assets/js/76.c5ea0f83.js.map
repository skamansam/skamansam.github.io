{"version":3,"sources":["webpack:///./src/posts/2016-09-14-data-migrations-and-you.md?eb26","webpack:///./src/posts/2016-09-14-data-migrations-and-you.md","webpack:///./src/posts/2016-09-14-data-migrations-and-you.md?39e9"],"names":[],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA,0BAA0B,aAAa,0BAA0B,wBAAwB,qCAAqC,OAAO,gCAAgC,WAAW,OAAO,4BAA4B,UAAU,mCAAmC,+BAA+B,0gCAA0gC,OAAO,uDAAuD,UAAU,mCAAmC,0DAA0D,mjBAAmjB,mBAAmB,2PAA2P,wCAAwC,YAAY,gBAAgB,yBAAyB,wBAAwB,gBAAgB,yBAAyB,2CAA2C,gBAAgB,4BAA4B,4DAA4D,gBAAgB,0BAA0B,uCAAuC,gBAAgB,0BAA0B,sCAAsC,gBAAgB,6BAA6B,2BAA2B,gBAAgB,6BAA6B,2BAA2B,gBAAgB,0BAA0B,kDAAkD,gBAAgB,yBAAyB,yCAAyC,gBAAgB,mCAAmC,aAAa,gBAAgB,yBAAyB,8BAA8B,gBAAgB,6BAA6B,2BAA2B,gBAAgB,0BAA0B,4DAA4D,gBAAgB,wBAAwB,wDAAwD,gBAAgB,yBAAyB,wCAAwC,gBAAgB,0BAA0B,uCAAuC,gBAAgB,0BAA0B,+CAA+C,gBAAgB,6BAA6B,iDAAiD,gBAAgB,wBAAwB,sDAAsD,gBAAgB,6BAA6B,iDAAiD,gBAAgB,wBAAwB,mDAAmD,gBAAgB,6BAA6B,iDAAiD,gBAAgB,wBAAwB,uDAAuD,gBAAgB,6BAA6B,sDAAsD,gBAAgB,6BAA6B,uCAAuC,gBAAgB,yBAAyB,gDAAgD,gBAAgB,yBAAyB,4CAA4C,gBAAgB,yBAAyB,8CAA8C,gBAAgB,yBAAyB,yCAAyC,gBAAgB,mCAAmC,aAAa,gBAAgB,yBAAyB,8BAA8B,gBAAgB,6BAA6B,2BAA2B,gBAAgB,0BAA0B,4DAA4D,gBAAgB,wBAAwB,2DAA2D,gBAAgB,yBAAyB,0CAA0C,gBAAgB,yBAAyB,opBAAopB,wCAAwC,YAAY,gBAAgB,yBAAyB,wBAAwB,gBAAgB,yBAAyB,2CAA2C,gBAAgB,4BAA4B,gFAAgF,gBAAgB,0BAA0B,uCAAuC,gBAAgB,0BAA0B,sCAAsC,gBAAgB,6BAA6B,2BAA2B,gBAAgB,6BAA6B,2BAA2B,gBAAgB,0BAA0B,kDAAkD,gBAAgB,yBAAyB,yCAAyC,gBAAgB,mCAAmC,aAAa,gBAAgB,0BAA0B,8DAA8D,gBAAgB,wBAAwB,4CAA4C,gBAAgB,6BAA6B,uCAAuC,gBAAgB,wBAAwB,uCAAuC,gBAAgB,6BAA6B,uCAAuC,gBAAgB,wBAAwB,iDAAiD,gBAAgB,0BAA0B,yCAAyC,gBAAgB,6BAA6B,yCAAyC,gBAAgB,6BAA6B,2BAA2B,gBAAgB,yBAAyB,0CAA0C,gBAAgB,yBAAyB,wCAAwC,gBAAgB,0BAA0B,wCAAwC,gBAAgB,0BAA0B,gDAAgD,gBAAgB,6BAA6B,uDAAuD,gBAAgB,6BAA6B,kDAAkD,gBAAgB,6BAA6B,uCAAuC,gBAAgB,0BAA0B,yCAAyC,gBAAgB,6BAA6B,2BAA2B,gBAAgB,6BAA6B,2BAA2B,gBAAgB,0BAA0B,kCAAkC,gBAAgB,6BAA6B,wCAAwC,gBAAgB,6BAA6B,+CAA+C,gBAAgB,0BAA0B,uCAAuC,gBAAgB,wBAAwB,uCAAuC,gBAAgB,6BAA6B,uCAAuC,gBAAgB,wBAAwB,2BAA2B,gBAAgB,6BAA6B,2BAA2B,gBAAgB,6BAA6B,4CAA4C,gBAAgB,yBAAyB,8DAA8D,gBAAgB,wBAAwB,4CAA4C,gBAAgB,6BAA6B,uCAAuC,gBAAgB,wBAAwB,kEAAkE,gBAAgB,wBAAwB,4CAA4C,gBAAgB,6BAA6B,uCAAuC,gBAAgB,wBAAwB,uCAAuC,gBAAgB,6BAA6B,uCAAuC,gBAAgB,wBAAwB,kDAAkD,gBAAgB,yBAAyB,0CAA0C,gBAAgB,yBAAyB,0gEAA0gE,OAAO,iCAAiC,UAAU,mCAAmC,oCAAoC,6zCAA6zC,OAAO,iCAAiC,UAAU,mCAAmC,oCAAoC,4EAA4E,oBAAoB,oEAAoE,QAAQ,8BAA8B,6EAA6E,yBAAyB,kEAAkE,wBAAwB;AACp3b;;;;;;;;;;;;;;ACDA;AAAA;AAAA;AAAgH;AAChH;;;AAGA;AAC0F;AAC1F,gBAAgB,2GAAU;AAC1B;AACA,EAAE,4GAAM;AACR,EAAE,qHAAe;AACjB;AACA;AACA;AACA;;AAEA;;AAEe,gF;;;;;;;;;;;;ACjBf;AAAA;AAAA;AAAA;AAAA;AAAA","file":"assets/js/76.c5ea0f83.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('ContentSlotsDistributor',{attrs:{\"slot-key\":_vm.$parent.slotKey}},[_c('h2',{attrs:{\"id\":\"a-little-background\"}},[_c('a',{staticClass:\"header-anchor\",attrs:{\"href\":\"#a-little-background\"}},[_vm._v(\"#\")]),_vm._v(\" A Little Background\")]),_vm._v(\" \"),_c('p',[_vm._v(\"The university from which I graduated did not teach any programming patterns, so when I entered the job market, I was not\\nsure what \"),_c('em',[_vm._v(\"programming patterns\")]),_vm._v(\" (a.k.a. \\\"\"),_c('em',[_vm._v(\"design patterns\")]),_vm._v(\"\\\")Â even were. My first job was definitely a learning experience,\\nbut since I was on a small team with other newbies, I didn't have many opportunities to grow well as a developer. So when\\nI got my second job, with developers of all walks and experiences, I was thrown into many, many discussions about what\\npattern to apply to what idea. It was a little confusing at first, but very exhilarating! Here was the chance to lose\\nsome old, bad habits, and replace them with new \"),_c('em',[_vm._v(\"Patterns\")]),_vm._v(\"! This post is about some patterns I really really like.\\nI will add references and information about each pattern so you can learn as much about them them as you want!\")]),_vm._v(\" \"),_c('h2',{attrs:{\"id\":\"migrations-are-only-for-modifying-the-database\"}},[_c('a',{staticClass:\"header-anchor\",attrs:{\"href\":\"#migrations-are-only-for-modifying-the-database\"}},[_vm._v(\"#\")]),_vm._v(\" Migrations Are Only For Modifying The Database\")]),_vm._v(\" \"),_c('p',[_vm._v(\"This is a difficult rule to follow for lots of Rails developers, experienced and not so. Since migrations are usually\\nautomated, it is easy to get in the mindset of adding data changes to migrations. This violates the\\n\"),_c('strong',[_vm._v(\"Single Responsibility Principle\")]),_vm._v(\", which states, \"),_c('em',[_vm._v(\"A class should have a responsibility over a single feature of your application\")]),_vm._v(\".\")]),_vm._v(\" \"),_c('blog-note',[_c('div',{staticClass:\"note\"},[_c('p',[_vm._v(\"Scenario: You have a nice chat app and you want to add the ability for users to 'favorite' certain messages.\\nAt first, you have a boolean field in your database, so your original migration looks like this:\")]),_vm._v(\" \"),_c('div',{staticClass:\"language-ruby extra-class\"},[_c('pre',{pre:true,attrs:{\"class\":\"language-ruby\"}},[_c('code',[_c('span',{pre:true,attrs:{\"class\":\"token keyword\"}},[_vm._v(\"class\")]),_vm._v(\" \"),_c('span',{pre:true,attrs:{\"class\":\"token class-name\"}},[_vm._v(\"CreateMessageFavorites\")]),_vm._v(\" \"),_c('span',{pre:true,attrs:{\"class\":\"token operator\"}},[_vm._v(\"<\")]),_vm._v(\" \"),_c('span',{pre:true,attrs:{\"class\":\"token constant\"}},[_vm._v(\"ActiveRecord\")]),_c('span',{pre:true,attrs:{\"class\":\"token punctuation\"}},[_vm._v(\":\")]),_c('span',{pre:true,attrs:{\"class\":\"token punctuation\"}},[_vm._v(\":\")]),_c('span',{pre:true,attrs:{\"class\":\"token constant\"}},[_vm._v(\"Migration\")]),_vm._v(\"\\n  \"),_c('span',{pre:true,attrs:{\"class\":\"token keyword\"}},[_vm._v(\"def\")]),_vm._v(\" \"),_c('span',{pre:true,attrs:{\"class\":\"token method-definition\"}},[_c('span',{pre:true,attrs:{\"class\":\"token keyword\"}},[_vm._v(\"self\")]),_c('span',{pre:true,attrs:{\"class\":\"token punctuation\"}},[_vm._v(\".\")]),_c('span',{pre:true,attrs:{\"class\":\"token function\"}},[_vm._v(\"up\")])]),_vm._v(\"\\n    create_table \"),_c('span',{pre:true,attrs:{\"class\":\"token symbol\"}},[_vm._v(\":message_favorites\")]),_vm._v(\" \"),_c('span',{pre:true,attrs:{\"class\":\"token keyword\"}},[_vm._v(\"do\")]),_vm._v(\" \"),_c('span',{pre:true,attrs:{\"class\":\"token operator\"}},[_vm._v(\"|\")]),_vm._v(\"t\"),_c('span',{pre:true,attrs:{\"class\":\"token operator\"}},[_vm._v(\"|\")]),_vm._v(\"\\n      t\"),_c('span',{pre:true,attrs:{\"class\":\"token punctuation\"}},[_vm._v(\".\")]),_vm._v(\"references \"),_c('span',{pre:true,attrs:{\"class\":\"token symbol\"}},[_vm._v(\":message\")]),_vm._v(\"\\n      t\"),_c('span',{pre:true,attrs:{\"class\":\"token punctuation\"}},[_vm._v(\".\")]),_vm._v(\"references \"),_c('span',{pre:true,attrs:{\"class\":\"token symbol\"}},[_vm._v(\":user\")]),_vm._v(\"\\n      t\"),_c('span',{pre:true,attrs:{\"class\":\"token punctuation\"}},[_vm._v(\".\")]),_vm._v(\"boolean    \"),_c('span',{pre:true,attrs:{\"class\":\"token symbol\"}},[_vm._v(\":favorite\")]),_vm._v(\"\\n      t\"),_c('span',{pre:true,attrs:{\"class\":\"token punctuation\"}},[_vm._v(\".\")]),_vm._v(\"timestamps  null\"),_c('span',{pre:true,attrs:{\"class\":\"token punctuation\"}},[_vm._v(\":\")]),_vm._v(\" \"),_c('span',{pre:true,attrs:{\"class\":\"token boolean\"}},[_vm._v(\"false\")]),_vm._v(\"\\n    \"),_c('span',{pre:true,attrs:{\"class\":\"token keyword\"}},[_vm._v(\"end\")]),_vm._v(\"\\n  \"),_c('span',{pre:true,attrs:{\"class\":\"token keyword\"}},[_vm._v(\"end\")]),_vm._v(\"\\n\\n  \"),_c('span',{pre:true,attrs:{\"class\":\"token keyword\"}},[_vm._v(\"def\")]),_vm._v(\" \"),_c('span',{pre:true,attrs:{\"class\":\"token method-definition\"}},[_c('span',{pre:true,attrs:{\"class\":\"token keyword\"}},[_vm._v(\"self\")]),_c('span',{pre:true,attrs:{\"class\":\"token punctuation\"}},[_vm._v(\".\")]),_c('span',{pre:true,attrs:{\"class\":\"token function\"}},[_vm._v(\"down\")])]),_vm._v(\"\\n    drop_table \"),_c('span',{pre:true,attrs:{\"class\":\"token symbol\"}},[_vm._v(\":message_favorites\")]),_vm._v(\"\\n  \"),_c('span',{pre:true,attrs:{\"class\":\"token keyword\"}},[_vm._v(\"end\")]),_vm._v(\"\\n\"),_c('span',{pre:true,attrs:{\"class\":\"token keyword\"}},[_vm._v(\"end\")]),_vm._v(\"\\n\")])])]),_c('p',[_vm._v(\"After a few months, and many \"),_c('em',[_vm._v(\"many\")]),_vm._v(\" messages (6 million!), you decide you want the 'favorite' button to handle\\na few more emotions, such as \\\"makes me happy,\\\" \\\"makes me sad,\\\" \\\"makes me angry,\\\" \\\"makes me crazy,\\\" and \\\"meh,\\njust a note.\\\"\")])])]),_vm._v(\" \"),_c('p',[_vm._v(\"There are several ways of going about doing this. Once you analyze your requirements, you decide to use the\\nexisting \"),_c('code',[_vm._v(\"MessageFavorite#favorite\")]),_vm._v(\" field to store the new information.Your immediate thought is to use a\\nmigration as such:\")]),_vm._v(\" \"),_c('div',{staticClass:\"language-ruby extra-class\"},[_c('pre',{pre:true,attrs:{\"class\":\"language-ruby\"}},[_c('code',[_c('span',{pre:true,attrs:{\"class\":\"token keyword\"}},[_vm._v(\"class\")]),_vm._v(\" \"),_c('span',{pre:true,attrs:{\"class\":\"token class-name\"}},[_vm._v(\"UpdateMessageFavoritesToHandleMoreEmotions\")]),_vm._v(\" \"),_c('span',{pre:true,attrs:{\"class\":\"token operator\"}},[_vm._v(\"<\")]),_vm._v(\" \"),_c('span',{pre:true,attrs:{\"class\":\"token constant\"}},[_vm._v(\"ActiveRecord\")]),_c('span',{pre:true,attrs:{\"class\":\"token punctuation\"}},[_vm._v(\":\")]),_c('span',{pre:true,attrs:{\"class\":\"token punctuation\"}},[_vm._v(\":\")]),_c('span',{pre:true,attrs:{\"class\":\"token constant\"}},[_vm._v(\"Migration\")]),_vm._v(\"\\n  \"),_c('span',{pre:true,attrs:{\"class\":\"token keyword\"}},[_vm._v(\"def\")]),_vm._v(\" \"),_c('span',{pre:true,attrs:{\"class\":\"token method-definition\"}},[_c('span',{pre:true,attrs:{\"class\":\"token function\"}},[_vm._v(\"change\")])]),_vm._v(\"\\n    add_column \"),_c('span',{pre:true,attrs:{\"class\":\"token symbol\"}},[_vm._v(\":message_favorites\")]),_c('span',{pre:true,attrs:{\"class\":\"token punctuation\"}},[_vm._v(\",\")]),_vm._v(\" \"),_c('span',{pre:true,attrs:{\"class\":\"token symbol\"}},[_vm._v(\":favorite_int\")]),_c('span',{pre:true,attrs:{\"class\":\"token punctuation\"}},[_vm._v(\",\")]),_vm._v(\" \"),_c('span',{pre:true,attrs:{\"class\":\"token symbol\"}},[_vm._v(\":int\")]),_vm._v(\"\\n\\n    \"),_c('span',{pre:true,attrs:{\"class\":\"token constant\"}},[_vm._v(\"MessageFavorite\")]),_c('span',{pre:true,attrs:{\"class\":\"token punctuation\"}},[_vm._v(\".\")]),_vm._v(\"all\"),_c('span',{pre:true,attrs:{\"class\":\"token punctuation\"}},[_vm._v(\".\")]),_c('span',{pre:true,attrs:{\"class\":\"token keyword\"}},[_vm._v(\"each\")]),_vm._v(\" \"),_c('span',{pre:true,attrs:{\"class\":\"token keyword\"}},[_vm._v(\"do\")]),_vm._v(\" \"),_c('span',{pre:true,attrs:{\"class\":\"token operator\"}},[_vm._v(\"|\")]),_vm._v(\"mf\"),_c('span',{pre:true,attrs:{\"class\":\"token operator\"}},[_vm._v(\"|\")]),_vm._v(\"\\n      mf\"),_c('span',{pre:true,attrs:{\"class\":\"token punctuation\"}},[_vm._v(\".\")]),_vm._v(\"update_attributes\"),_c('span',{pre:true,attrs:{\"class\":\"token punctuation\"}},[_vm._v(\"(\")]),_vm._v(\"favorite_int\"),_c('span',{pre:true,attrs:{\"class\":\"token punctuation\"}},[_vm._v(\":\")]),_vm._v(\" \"),_c('span',{pre:true,attrs:{\"class\":\"token constant\"}},[_vm._v(\"MessageFavorite\")]),_c('span',{pre:true,attrs:{\"class\":\"token punctuation\"}},[_vm._v(\":\")]),_c('span',{pre:true,attrs:{\"class\":\"token punctuation\"}},[_vm._v(\":\")]),_c('span',{pre:true,attrs:{\"class\":\"token constant\"}},[_vm._v(\"EMOTIONS\")]),_c('span',{pre:true,attrs:{\"class\":\"token punctuation\"}},[_vm._v(\"[\")]),_vm._v(\"mf\"),_c('span',{pre:true,attrs:{\"class\":\"token punctuation\"}},[_vm._v(\".\")]),_vm._v(\"favorite \"),_c('span',{pre:true,attrs:{\"class\":\"token operator\"}},[_vm._v(\"?\")]),_vm._v(\" \"),_c('span',{pre:true,attrs:{\"class\":\"token number\"}},[_vm._v(\"1\")]),_vm._v(\" \"),_c('span',{pre:true,attrs:{\"class\":\"token punctuation\"}},[_vm._v(\":\")]),_vm._v(\" \"),_c('span',{pre:true,attrs:{\"class\":\"token number\"}},[_vm._v(\"0\")]),_c('span',{pre:true,attrs:{\"class\":\"token punctuation\"}},[_vm._v(\"]\")]),_c('span',{pre:true,attrs:{\"class\":\"token punctuation\"}},[_vm._v(\")\")]),_vm._v(\"\\n    \"),_c('span',{pre:true,attrs:{\"class\":\"token keyword\"}},[_vm._v(\"end\")]),_vm._v(\"\\n\\n    remove_column \"),_c('span',{pre:true,attrs:{\"class\":\"token symbol\"}},[_vm._v(\":message_favorites\")]),_c('span',{pre:true,attrs:{\"class\":\"token punctuation\"}},[_vm._v(\",\")]),_vm._v(\" \"),_c('span',{pre:true,attrs:{\"class\":\"token symbol\"}},[_vm._v(\":favorite\")]),_vm._v(\"\\n    rename_column \"),_c('span',{pre:true,attrs:{\"class\":\"token symbol\"}},[_vm._v(\":message_favorites\")]),_c('span',{pre:true,attrs:{\"class\":\"token punctuation\"}},[_vm._v(\",\")]),_vm._v(\" \"),_c('span',{pre:true,attrs:{\"class\":\"token symbol\"}},[_vm._v(\":favorite_int\")]),_c('span',{pre:true,attrs:{\"class\":\"token punctuation\"}},[_vm._v(\",\")]),_vm._v(\" \"),_c('span',{pre:true,attrs:{\"class\":\"token symbol\"}},[_vm._v(\":favorite\")]),_vm._v(\"\\n  \"),_c('span',{pre:true,attrs:{\"class\":\"token keyword\"}},[_vm._v(\"end\")]),_vm._v(\"\\n\"),_c('span',{pre:true,attrs:{\"class\":\"token keyword\"}},[_vm._v(\"end\")]),_vm._v(\"\\n\")])])]),_c('p',[_vm._v(\"There are a few problems with this approach, chiefly, running a data migration in the middle of a Rails\\nmigration like this is going to grind things to a halt. Your deploy is going to take forever! There is also an\\nissue of what happens when there is an error in your data migration which will prevent everything from happening\\nand could leave you with dangling data that another migration won't be able to fix.\")]),_vm._v(\" \"),_c('p',[_vm._v(\"Change in environment is also a big issue. You may have this thoroughly tested while in development or in testing\\nenvironments, but production is known to throw a wrench into the works. This untested environment means you need\\nto baby-sit your data migration, which you won't be able to do while it's in a deploy migration. You will need\\nto run this separately, in a production console.\")]),_vm._v(\" \"),_c('p',[_vm._v(\"Finally, there is the obvious issue of violations to the \"),_c('strong',[_vm._v(\"SRP\")]),_vm._v(\". This migration does three things:\")]),_vm._v(\" \"),_c('ol',[_c('li',[_vm._v(\"creates a new temporary column\")]),_vm._v(\" \"),_c('li',[_vm._v(\"creates the new data based on the existing data\")]),_vm._v(\" \"),_c('li',[_vm._v(\"replaces the original column with the new column\")])]),_vm._v(\" \"),_c('p',[_vm._v(\"The best way to address all these issues is to just break the migration up into its distinct pieces, by doing the following:\")]),_vm._v(\" \"),_c('ol',[_c('li',[_vm._v(\"create and run a migration to create a new column in the Db\")]),_vm._v(\" \"),_c('li',[_vm._v(\"run the data migration (in the production console)\")]),_vm._v(\" \"),_c('li',[_vm._v(\"create and run a migration to replace the old column with the new one\")])]),_vm._v(\" \"),_c('p',[_vm._v(\"For many of us, step 2 is a very daunting task. Rails consoles in production are a hairy endeavor and can lead to bad\\ndata integrity and other sorts of bad things, including deleting all data! Fortunately for you guys, Rails already\\nhas a solution for this.\")]),_vm._v(\" \"),_c('h3',{attrs:{\"id\":\"introducing-rails-runner\"}},[_c('a',{staticClass:\"header-anchor\",attrs:{\"href\":\"#introducing-rails-runner\"}},[_vm._v(\"#\")]),_vm._v(\" Introducing Rails Runner\")]),_vm._v(\" \"),_c('p',[_vm._v(\"Rails runner is a great tool for running data migrations and other one-shot data changes in your Rails application. Rails\\nrunner runs a given file in the context of your Rails app. You can execute Rails runner as \"),_c('code',[_vm._v(\"rails runner bin/file.rb\")]),_vm._v(\" or\\n\"),_c('code',[_vm._v(\"rails r bin/file.rb\")]),_vm._v(\". While this won't solve data integrity issues, it will allow you to run a script in the current\\nRails context. This means you can have tested and peer reviewed data migrations! Amazing!\")]),_vm._v(\" \"),_c('p',[_vm._v(\"For ease of organization, you can put all your data migrations in \"),_c('code',[_vm._v(\"db/migrate/data/\")]),_vm._v(\". Another common place is\\n\"),_c('code',[_vm._v(\"bin/one-shot/:year/:month/\")]),_vm._v(\". If this is a hotfix for a tech support ticket, it is helpful to put the ticket number\\nin the name of the file, for instance \"),_c('code',[_vm._v(\"bin/one-shot/2016/09/TS-432098-update-bad-data.rb\")]),_vm._v(\". The point is, your team\\nshould agree on a place to put all these tickets so everyone can keep track of the changes. Developers can add a\\n\"),_c('code',[_vm._v(\"post_checkout\")]),_vm._v(\" git hook to automatically run all new scripts in the agreed-upon directory.\")]),_vm._v(\" \"),_c('h3',{attrs:{\"id\":\"flow-for-data-migrations\"}},[_c('a',{staticClass:\"header-anchor\",attrs:{\"href\":\"#flow-for-data-migrations\"}},[_vm._v(\"#\")]),_vm._v(\" Flow for Data Migrations\")]),_vm._v(\" \"),_c('div',{staticClass:\"chart\"},[_vm._v(\"\\n%% Waiting for the following chart to load...\\ngraph TB;\\n  db?{database needs to be changed?}\\n  done[Done.]\\n  db[\\\"Run database migration (rails migration)\\\"]\\n  data?{data need to be changed?}\\n  data[\\\"run script to change data (one-shot)\\\"]\\n  db_cleanup?{database needs cleanup?}\\n  db? -- yes --> db\\n  db? -- no  --> done\\n  db  --> data?\\n  data? -- no -->done\\n  data? -- yes --> data\\n  data --> db_cleanup?\\n  db_cleanup? -- yes --> db\\n  db_cleanup? -- no --> done\\n\")]),_vm._v(\" \"),_c('p',[_vm._v(\"If you want to run any migration in Rails, just follow these easy steps:\")]),_vm._v(\" \"),_c('ol',[_c('li',[_c('p',[_vm._v(\"For data migrations, create a one-shot and use \"),_c('code',[_vm._v(\"rails runner\")]),_vm._v(\". This is a best practice because it allows your\\nteam to test and review your changes. \"),_c('strong',[_vm._v(\"NEVER EVER EVER RUN A PRODUCTION CONSOLE!\")])])]),_vm._v(\" \"),_c('li',[_c('p',[_vm._v(\"Use \"),_c('code',[_vm._v(\"rails migrations\")]),_vm._v(\" \"),_c('strong',[_vm._v(\"FOR DATABASE MODEL CHANGES ONLY\")])])]),_vm._v(\" \"),_c('li',[_c('p',[_vm._v(\"Apply rules \"),_c('em',[_vm._v(\"1\")]),_vm._v(\" and \"),_c('em',[_vm._v(\"2\")]),_vm._v(\" as liberally as possible.\")])])]),_vm._v(\" \"),_c('p',[_vm._v(\"If you want to create a data migration, use one-shots. If you want to create a data migration with a database\\nchange, separate the two concerns into a Rails migration, then a data migration, then a cleanup migration if\\nneeded. Of course, YMMV, as with any best practice, just make sure your team is onboard with it and, above all,\\nremember that agreeing on standard practices is the core of a happy team!\")])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import { render, staticRenderFns } from \"./2016-09-14-data-migrations-and-you.md?vue&type=template&id=bd50ed6a&\"\nvar script = {}\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../node_modules/cache-loader/dist/cjs.js?{\\\"cacheDirectory\\\":\\\"node_modules/@vuepress/core/node_modules/.cache/vuepress\\\",\\\"cacheIdentifier\\\":\\\"3cbb318b-vue-loader-template\\\"}!../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??ref--1-1!../../node_modules/@vuepress/markdown-loader/index.js??ref--1-2!./2016-09-14-data-migrations-and-you.md?vue&type=template&id=bd50ed6a&\""],"sourceRoot":""}