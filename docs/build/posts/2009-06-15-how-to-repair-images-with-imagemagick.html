<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" href="../favicon/favicon.ico" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
    <link rel="manifest" href="/favicon/site.webmanifest">
    <link rel="mask-icon" href="/favicon/safari-pinned-tab.svg" color="#999999">
    <meta name="msapplication-TileColor" content="#cccccc">
    <meta name="theme-color" content="#eeeeee">
		<meta http-equiv="content-security-policy" content=""><title>How To Repair Images with ImageMagick | RBE</title><meta property="og:image" content="/images/GSoC-logo-horizontal-800.png" data-svelte="svelte-gwb5t8"><meta content="/images/GSoC-logo-horizontal-800.png" data-svelte="svelte-gwb5t8"><meta property="og:site_name" content="Rude Boy Solutions" data-svelte="svelte-gwb5t8"><meta property="article:published_time" content="2009-06-15T11:23:00.000Z" data-svelte="svelte-gwb5t8"><meta property="article:author" content="skamansam" data-svelte="svelte-gwb5t8"><meta property="og:url" content="" data-svelte="svelte-gwb5t8"><meta property="og:type" content="article" data-svelte="svelte-gwb5t8"><meta property="og:title" content="How To Repair Images with ImageMagick - RBE" data-svelte="svelte-gwb5t8"><meta property="og:image" content="false" data-svelte="svelte-gwb5t8"><meta property="og:description" content="Using ImageMagick to repair corrupted images" data-svelte="svelte-gwb5t8"><meta name="twitter:card" content="summary" data-svelte="svelte-gwb5t8"><meta property="twitter:site" content="@skamansam" data-svelte="svelte-gwb5t8"><meta name="twitter:creator" content="@skamansam" data-svelte="svelte-gwb5t8"><meta name="twitter:image" content="false" data-svelte="svelte-gwb5t8"><meta name="description" content="Using ImageMagick to repair corrupted images" data-svelte="svelte-gwb5t8">
	<link rel="stylesheet" href="/_app/immutable/assets/pages/__layout.svelte-4739f310.css">
	<link rel="modulepreload" href="/_app/immutable/start-2113cc8b.js">
	<link rel="modulepreload" href="/_app/immutable/chunks/index-f095e7d9.js">
	<link rel="modulepreload" href="/_app/immutable/pages/__layout.svelte-d2dbcbfa.js">
	<link rel="modulepreload" href="/_app/immutable/pages/posts/2009-06-15-how-to-repair-images-with-imagemagick.md-601d53d1.js">
	<link rel="modulepreload" href="/_app/immutable/chunks/post-34b2f3fb.js">
			<script>
		if ('serviceWorker' in navigator) {
			addEventListener('load', () => {
				navigator.serviceWorker.register('/service-worker.js');
			});
		}
	</script>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-1CV0J6F3VM"></script>
    <!-- <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script> -->
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-G3FBL50ZMF');
    </script>
  </head>
	<body>
		


<div class="theme-wrapper light theme- h-screen w-screen p-0 m-0 flex flex-col items-stretch"><header class="site-head flex  svelte-1b8k5if"><div class="header-logo inline-block"><img src="/rbe_logo.gif" alt="Rude Boy Enterprises Logo" width="100"></div>
	<div class="flex flex-col grow justify-center ml-3"><div class="text-4xl text-onPrimaryBg">Rude Boy Solutions</div>
		<div class="indent-5">Solutions. For Life.</div></div>
	<div class="mt-2 mr-2 text-sm"><label for="themeSelector">Theme: </label>
		<select id="themeSelector"><option value="">plain</option><option value="neumorphic">neumorphic</option><option value="glassmorphic">glassmorphic</option><option value="brutal">brutal</option></select>

		<label for="toggle-dark" class="flex items-center cursor-pointer relative mb-4"><span class="mr-3 text-gray-900 text-sm font-medium flex-grow">Dark Mode</span>
			<input type="checkbox" id="toggle-dark" class="sr-only svelte-1b8k5if">
			<div class="toggle-bg bg-gray-200 border-2 border-gray-200 h-6 mr-5 w-11 rounded-full self-end svelte-1b8k5if"></div></label></div>
</header>
  <nav class="sidebar "><ul class=""><li><a href="/portfolio">Portfolio</a></li>
    <li><a href="/posts">Blog</a></li>
    <li><a href="/about">About</a></li>
    <li><a href="/contact">Contact</a></li>
    <li><a href="/demo">MD Demo</a></li></ul></nav>
  <div class="pl-2 pt-2">



<main><article><hgroup><h1>How To Repair Images with ImageMagick</h1>
			<p class="date created_at">posted on: 6/15/2009, 11:23:00 AM</p>
			
			<p class="author">by: skamansam</p></hgroup>
		<div class="description hidden">Using ImageMagick to repair corrupted images</div>
		<p>I have been doing a lot of importing of photos on my photo site, and have noticed some images do not display properly.
Since I love ImageMagick so much, I set up  my gallery to use it. However, there appears to be a check in the Coppermine
software that aborts reading the file upon errors in the image. So I typed the command “display imagename.jpg” for some
of the files that did not import properly, and everything appeared to be fine. But I did notice something peculiar about
the images: they were taken with my phone’s camera and all had errors printed out when I tried to open them, but seem to
display correctly.</p>
<p>Since these files could be opened by ImageMagick, I figured if I saved them again, I would be able to fix the errors. I
ran “convert image1.jpg image1.jpg”, got the familiar errors printed and opened the file again. This time, no errors!
But since I have a  lot of files I want to import, I needed a way to convert a bunch at once.</p>
<p>I created a neat little Perl script to do just that. All you need is ImageMagick and perl installed. This script does
not rely on PerlMagick, as it runs the convert command. So here it is:</p>
<pre class="language-perl"><!-- HTML_TAG_START --><code class="language-perl"><span class="token comment">#!/usr/bin/perl</span>

processFile<span class="token punctuation">(</span><span class="token string">"$_"</span><span class="token punctuation">)</span> <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">@ARGV</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">#recursively fix images</span>
<span class="token keyword">sub</span> <span class="token function">processFile</span> <span class="token punctuation">&#123;</span>
   <span class="token keyword">my</span> <span class="token variable">$file</span><span class="token operator">=</span>shift<span class="token punctuation">;</span>
   <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token operator">-d</span> <span class="token string">"$file"</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">(</span> <span class="token keyword">do</span><span class="token punctuation">&#123;</span> processFile<span class="token punctuation">(</span><span class="token string">"$_"</span><span class="token punctuation">)</span> <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token string">"$file"</span><span class="token operator">/</span><span class="token operator">*</span><span class="token operator">></span><span class="token punctuation">)</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token string">&#96;convert "$file" "$file"&#96;</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code><!-- HTML_TAG_END --></pre>
<p>I saved this file as $HOME/bin/fiximage. All you need to do to run it is type “fiximage file1 file2 directory1 directory2 …“.
One other thing to note is that this script has been purposefully shortened. I like to use the ternary operator whenever
possible in my scripts for just this reason. As such, it does not print anything to the command line itself, but if the
convert command encounters an error, that will be printed.</p>
<p>I hope you have found this article useful!</p></article></main></div></div>


		<script type="module" data-sveltekit-hydrate="yyxtyh">
		import { start } from "/_app/immutable/start-2113cc8b.js";
		start({
			target: document.querySelector('[data-sveltekit-hydrate="yyxtyh"]').parentNode,
			paths: {"base":"","assets":""},
			session: {},
			route: true,
			spa: false,
			trailing_slash: "never",
			hydrate: {
				status: 200,
				error: null,
				nodes: [0, 31],
				params: {},
				routeId: "posts/2009-06-15-how-to-repair-images-with-imagemagick"
			}
		});
	</script>
	</body>
</html>
